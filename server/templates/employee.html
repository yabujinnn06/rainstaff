<!doctype html>
<html lang="tr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Calisan Detay - {{ employee['full_name'] }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  </head>
  <body class="admin dark-theme">
    <header class="topbar">
      <div class="brand">
        <button class="sidebar-toggle" id="sidebarToggle" aria-label="Menu">
          <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
            <path d="M3 12h18M3 6h18M3 18h18"/>
          </svg>
        </button>

        <div class="brand-title">Calisan Kart</div>
        <div class="brand-sub">{{ employee['full_name'] }}</div>
      </div>
      <div class="sync">
        <a class="logout" href="/dashboard">Dashboard</a>
        <a class="logout" href="/logout">Cikis</a>
      </div>
    </header>
    <div class="backdrop" id="sidebarBackdrop"></div>



    <div class="layout">
      {% include "_sidebar.html" %}
      <main class="content single">
      <section class="section">
        <div class="panel">
          <div class="panel-head">
            <h2>Calisan Bilgisi</h2>
          </div>
          <div class="info-grid">
            <div><span>Ad Soyad:</span> {{ employee['full_name'] }}</div>
            <div><span>Departman:</span> {{ employee['department'] or '-' }}</div>
            <div><span>Unvan:</span> {{ employee['title'] or '-' }}</div>
            <div><span>TCKN:</span> {{ employee['identity_no'] or '-' }}</div>
          </div>
        </div>
      </section>

      <section class="section filter-bar">
        <div class="panel-head">
          <h2>Tarih Araligi</h2>
        </div>
        <form method="get" class="filter-form">
          <label>Baslangic</label>
          <input type="date" name="start" value="{{ start_date }}" />
          <label>Bitis</label>
          <input type="date" name="end" value="{{ end_date }}" />
          <label class="check">
            <input type="checkbox" name="all" value="1" {% if all_months %}checked{% endif %} />
            Tum Aylar
          </label>
          <button type="submit">Uygula</button>
        </form>
      </section>

      <section class="section grid-2">
        <div class="panel">
          <div class="panel-head">
            <h2>Toplamlar</h2>
          </div>
          <div class="range-cards">
            <div class="mini-card">
              <div class="label">Calisilan Saat</div>
              <div class="value">{{ totals.worked }}</div>
            </div>
            <div class="mini-card warn">
              <div class="label">Fazla Mesai</div>
              <div class="value">{{ totals.overtime }}</div>
            </div>
            <div class="mini-card">
              <div class="label">Gece</div>
              <div class="value">{{ totals.night }}</div>
            </div>
            <div class="mini-card">
              <div class="label">Ozel Gun</div>
              <div class="value">{{ totals.special }}</div>
            </div>
          </div>
        </div>

        <div class="panel">
          <div class="panel-head">
            <h2>Gunluk Detay</h2>
          </div>
          <div class="table-wrap tall">
            <table>
              <thead>
                <tr>
                  <th>Tarih</th>
                  <th>Giris</th>
                  <th>Cikis</th>
                  <th>Mola</th>
                  <th>Calisilan</th>
                  <th>Fazla Mesai</th>
                  <th>Gece</th>
                  <th>Ozel Gun</th>
                </tr>
              </thead>
              <tbody>
                {% if day_rows %}
                  {% for row in day_rows %}
                    <tr>
                      <td>{{ row['date'] }}</td>
                      <td>{{ row['start'] }}</td>
                      <td>{{ row['end'] }}</td>
                      <td>{{ row['break'] }}</td>
                      <td>{{ row['worked'] }}</td>
                      <td>{{ row['overtime'] }}</td>
                      <td>{{ row['night'] }}</td>
                      <td>{{ row['special_hours'] }}</td>
                    </tr>
                  {% endfor %}
                {% else %}
                  <tr><td colspan="8">Kayit yok</td></tr>
                {% endif %}
              </tbody>
            </table>
          </div>
        </div>
      </section>
      </main>
    </div>
    <script>
      const allToggle = document.querySelector('input[name="all"]');
      const startInput = document.querySelector('input[name="start"]');
      const endInput = document.querySelector('input[name="end"]');
      if (allToggle && startInput && endInput) {
        const toggleDates = () => {
          const disabled = allToggle.checked;
          startInput.disabled = disabled;
          endInput.disabled = disabled;
        };
        allToggle.addEventListener("change", toggleDates);
        toggleDates();
      }
    </script>
  <script src="{{ url_for('static', filename='app.js') }}"></script>
  </body>
</html>
